# Spreadsheet-analyzer-Agent


A lightweight **Streamlit** application that lets you upload a CSV file, ask natural‑language questions about its contents, and receive answers generated by an LLM (OpenAI `gpt‑4o‑mini`).

The app automatically:

- Reads the uploaded CSV into a pandas `DataFrame`.
- Summarises the data (columns, head, info) and sends this context to the LLM.
- Generates Python code that answers the user query, ensuring the result is stored in a variable called `result`.
- Executes the generated code locally and displays the result (DataFrame, scalar, or plot).

## Repository Structure

```
csv-analyzer-agent/
├─ csv_agent.py          # Main Streamlit entry point (the script you uploaded)
├─ requirements.txt     # Python dependencies
├─ .env.example         # Example environment file for the OpenAI key
└─ README.md            # This file
```

> **Note**: The current implementation lives in `csv_agent.py`. The previous `standalone_csv_agent.py` was renamed for clarity.

## Prerequisites

- **Python 3.12+** (tested on 3.13)
- **Conda** or **virtualenv** for environment isolation (optional but recommended)
- An **OpenAI API key** with access to `gpt‑4o‑mini`


### `requirements.txt`

```
streamlit
pandas
openai
python-dotenv
matplotlib
```

## Configuration

Create a `.env` file in the project root (or set the environment variable directly) containing your OpenAI key:

```dotenv
OPENAI_API_KEY=sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
```

The app will also read `OPENAI_API_KEY` from the system environment if the `.env` file is missing.

## Running the App

```bash
streamlit run csv_agent.py
```

Open the URL printed in the terminal (usually `http://localhost:8501`).

## Usage

1. **Upload a CSV** using the file uploader in the sidebar.
2. **Enter a question** in the chat input, e.g., `What is the average sales value?`.
3. The app will:
   - Send a prompt with the data context to the LLM.
   - Receive generated Python code wrapped in a markdown code block.
   - Execute the code locally.
   - Show the result (DataFrame, number, string, or plot).

### Example Query

```
What is the total revenue for each product category?
```

The LLM will generate code similar to:

```python
result = df.groupby('category')['revenue'].sum()
```

and the app will display the resulting DataFrame.

## Validation & Debugging

- Use the **Validate API Key** button in the sidebar to ensure your key works before querying.
- Errors from code generation or execution are shown in the chat window for easy debugging.

## Contributing

Feel free to open issues or submit pull requests. Suggested improvements:

- Cache generated code for faster subsequent queries.
- Extend the prompt to handle more complex visualisations.

## License

This project is licensed under the MIT License.
